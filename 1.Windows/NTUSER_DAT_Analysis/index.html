
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jrjones9440.github.io/DFIR-Techniques/1.Windows/NTUSER_DAT_Analysis/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>NTUSER.DAT Analysis (DFIR) - DFIR Techniques</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ntuserdat-analysis-dfir" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DFIR Techniques" class="md-header__button md-logo" aria-label="DFIR Techniques" data-md-component="logo">
      
  <img src="../../img/CND_LogoTop.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DFIR Techniques
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NTUSER.DAT Analysis (DFIR)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jrjones9440/DFIR-Techniques" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Windows

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Linux/" class="md-tabs__link">
          
  
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Networking/" class="md-tabs__link">
          
  
  
    
  
  Networking

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Cloud/" class="md-tabs__link">
          
  
  
    
  
  Cloud

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Malware/" class="md-tabs__link">
          
  
  
    
  
  Malware

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ICS/" class="md-tabs__link">
          
  
  
    
  
  ICS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Tools/" class="md-tabs__link">
          
  
  
    
  
  Tools

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DFIR Techniques" class="md-nav__button md-logo" aria-label="DFIR Techniques" data-md-component="logo">
      
  <img src="../../img/CND_LogoTop.jpg" alt="logo">

    </a>
    DFIR Techniques
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jrjones9440/DFIR-Techniques" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Windows
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Windows
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Linux/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Linux
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Networking/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Networking
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Cloud/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Malware/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Malware
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Malware
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ICS/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    ICS
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    ICS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../Tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifact-location" class="md-nav__link">
    <span class="md-ellipsis">
      
        Artifact Location
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools-used" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tools Used
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/jrjones9440/DFIR-Techniques/edit/master/docs/1.Windows/NTUSER_DAT_Analysis.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/jrjones9440/DFIR-Techniques/raw/master/docs/1.Windows/NTUSER_DAT_Analysis.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="ntuserdat-analysis-dfir">NTUSER.DAT Analysis (DFIR)<a class="headerlink" href="#ntuserdat-analysis-dfir" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The <strong>NTUSER.DAT</strong> registry hive contains <strong>per-user configuration and activity artifacts</strong> for a Windows profile. From a DFIR standpoint, NTUSER.DAT is one of the most valuable artifacts to:</p>
<ul>
<li>Identify <strong>user intent</strong> (searches, typed paths, recent documents)</li>
<li>Recover evidence of <strong>file access</strong> and <strong>data staging/exfil</strong></li>
<li>Attribute actions to a specific user profile</li>
<li>Detect <strong>persistence mechanisms</strong> (Run keys)</li>
<li>Correlate activity with a timeframe of interest</li>
</ul>
<p>This document provides a structured workflow for analyzing NTUSER.DAT using:</p>
<ul>
<li><strong>Registry Explorer</strong> (interactive analysis)</li>
<li><strong>RECmd.exe</strong> (automation at scale)</li>
</ul>
<hr />
<h2 id="artifact-location">Artifact Location<a class="headerlink" href="#artifact-location" title="Permanent link">&para;</a></h2>
<p><strong>Registry Hive:</strong> <code>NTUSER.DAT</code><br />
<strong>Typical Path:</strong>  <code>C:\Users\{user}\NTUSER.DAT</code></p>
<p>Associated transaction logs (if present):
- <code>ntuser.dat.LOG1</code>
- <code>ntuser.dat.LOG2</code></p>
<hr />
<h2 id="tools-used">Tools Used<a class="headerlink" href="#tools-used" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Registry Explorer</strong> (Eric Zimmerman)</li>
<li><strong>RECmd.exe</strong> + <strong>Timeline Explorer</strong> (Eric Zimmerman)</li>
</ul>
<hr />
<h1 id="investigative-workflow-registry-explorer">Investigative Workflow ‚Äì Registry Explorer<a class="headerlink" href="#investigative-workflow-registry-explorer" title="Permanent link">&para;</a></h1>
<h2 id="step-1-prep-ntuserdat-hive-in-registry-explorer">Step 1 ‚Äî Prep NTUSER.DAT Hive in Registry Explorer<a class="headerlink" href="#step-1-prep-ntuserdat-hive-in-registry-explorer" title="Permanent link">&para;</a></h2>
<h3 id="procedure">Procedure<a class="headerlink" href="#procedure" title="Permanent link">&para;</a></h3>
<ol>
<li>Launch <strong>Registry Explorer</strong></li>
<li>Select <strong>File ‚Üí Load Hive</strong></li>
<li>Browse to the offline hive file  <ul>
<li>Example: <code>E:\C\Users\user1\NTUSER.DAT</code></li>
</ul>
</li>
<li>If a <strong>dirty hive</strong> is detected, select <strong>Yes</strong></li>
<li>Click <strong>OK</strong> to select the transaction logs to replay (skip if not prompted)</li>
<li>In the ‚ÄúOpen‚Äù dialog box navigate to offline hive file (such as E:\C\Users\user1) and highlight ntuser.dat.LOG1 and ntuser.dat.LOG2 by holding the CTRL key and clicking the filenames with your mouse. Select Open. (skip if no dirty hive detected).</li>
<li>Click <strong>OK</strong> to replay transaction logs</li>
<li>Select the save location to the directory you are working in, naming it something like: <code>NTUSER.DAT_clean</code></li>
<li>Select <strong>Yes</strong> when asked if you want to load the updated hive.</li>
<li>Select <strong>No</strong> when asked to load the dirty hive</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>![<span class="nt">Registry Explorer - Load NTUSER.DAT hive</span>](<span class="na">img/ntuser_analysis/01_load_ntuser_hive.png</span>)
</code></pre></div>
<hr />
<h2 id="step-2-wordwheelquery-search-terms">Step 2 ‚Äî WordWheelQuery (Search Terms)<a class="headerlink" href="#step-2-wordwheelquery-search-terms" title="Permanent link">&para;</a></h2>
<h3 id="registry-path">Registry Path<a class="headerlink" href="#registry-path" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery
</code></pre></div>
<h3 id="what-it-shows">What it shows<a class="headerlink" href="#what-it-shows" title="Permanent link">&para;</a></h3>
<p>Search terms typed into <strong>Windows Search / Explorer search</strong>.</p>
<h3 id="procedure_1">Procedure<a class="headerlink" href="#procedure_1" title="Permanent link">&para;</a></h3>
<ol>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery</code> in Registry Explorer.</li>
<li>Review the searches typed by the account in question and identify any suspicious search terms.<ul>
<li>MRU, or Most Recently Used, position is in descending order, position 0 is the most recent search.</li>
</ul>
</li>
<li>Document any searches with timestamps:<ul>
<li>WordWheelQuery does not maintain timestamps for its values, it does have one timestamp, the last write time of the key itself.</li>
<li>Since the key contains a Most Recently Used (MRU) list, we know that the most recent search conducted is present in MRU position 0.</li>
<li>Hence that search was conducted at the time WordWheelQuery was last written.</li>
</ul>
</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>![<span class="nt">Registry Explorer - WordWheelQuery searches</span>](<span class="na">img/ntuser_analysis/02_wordwheelquery.png</span>)
</code></pre></div>
<h3 id="dfir-notes">DFIR Notes<a class="headerlink" href="#dfir-notes" title="Permanent link">&para;</a></h3>
<ul>
<li>MRU list is <strong>descending</strong></li>
<li>MRU position <code>0</code> is the most recent search</li>
<li>Values <strong>do not store timestamps</strong></li>
<li>The key‚Äôs <strong>LastWrite timestamp</strong> indicates when the most recent search (MRU 0) occurred</li>
</ul>
<hr />
<h2 id="step-3-typedpaths-explorer-path-bar">Step 3 ‚Äî TypedPaths (Explorer Path Bar)<a class="headerlink" href="#step-3-typedpaths-explorer-path-bar" title="Permanent link">&para;</a></h2>
<h3 id="registry-path_1">Registry Path<a class="headerlink" href="#registry-path_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths
</code></pre></div>
<h3 id="what-it-shows_1">What it shows<a class="headerlink" href="#what-it-shows_1" title="Permanent link">&para;</a></h3>
<p>Locations typed manually into the <strong>Explorer address bar</strong>.</p>
<h3 id="procedure_2">Procedure<a class="headerlink" href="#procedure_2" title="Permanent link">&para;</a></h3>
<ol>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</code> key in Registry Explorer.</li>
<li>Document any suspicious entries:<ul>
<li>Examples are:<ul>
<li><code>\\server\share</code></li>
<li>removable drives (E:, F:)</li>
<li>staging folders (Temp, Downloads)</li>
<li>unusual admin shares (C$)</li>
</ul>
</li>
</ul>
</li>
<li>TypedPaths does not keep a MRU list, but does keep its entries in order by value name, thus the only timestamp that is available is for the most recent entry which is when the key was updated.</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>![<span class="nt">Registry Explorer - TypedPaths</span>](<span class="na">img/ntuser_analysis/03_typedpaths.png</span>)
</code></pre></div>
<h3 id="dfir-notes_1">DFIR Notes<a class="headerlink" href="#dfir-notes_1" title="Permanent link">&para;</a></h3>
<ul>
<li>No MRU list</li>
<li>Entries are ordered by <strong>value name</strong></li>
<li>Key <strong>LastWrite</strong> time reflects the most recent update (most recent entry)</li>
</ul>
<hr />
<h2 id="step-4-recentdocs-recent-file-activity">Step 4 ‚Äî RecentDocs (Recent File Activity)<a class="headerlink" href="#step-4-recentdocs-recent-file-activity" title="Permanent link">&para;</a></h2>
<h3 id="registry-path_2">Registry Path<a class="headerlink" href="#registry-path_2" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs
</code></pre></div>
<h3 id="what-it-shows_2">What it shows<a class="headerlink" href="#what-it-shows_2" title="Permanent link">&para;</a></h3>
<p>Recently opened documents by extension type.</p>
<h3 id="procedure_3">Procedure<a class="headerlink" href="#procedure_3" title="Permanent link">&para;</a></h3>
<ol>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code> key in Registry Explorer.</li>
<li>Timestamps in the RecentDocs key are identified via MRU lists and the last write times of registry keys. Each key has a timestamp and thus each of the sub-keys of RecentDocs keeps the time of the last file of that type to be opened.</li>
<li>These "extra" timestamps are collected in the Registry Explorer Recent documents plugin in the Extension Last Opened column. By reviewing this column you can bookend the time periods within which multiple files were opened.</li>
<li>The RecentDocs key keeps the order of items opened via its MRU key.</li>
<li>For example, if <strong>test.doc</strong> was opened on <strong>2025-10-10:50:25 UTC</strong> and is MRU position 41, that means that the 40 items above it in the list were all opened <strong>AFTER 2025-10-10:50:25 UTC</strong>.</li>
<li>Review the Extension Last Opened column in Registry Explorer and identify the filenames opened around the timeframe of interest and document timestamps.</li>
<li>Document drive letters referenced within RecentDocs by looking at the Target Name:<ul>
<li>You can search for interesting or sensitive files by searching within the Target Name field</li>
</ul>
</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>![<span class="nt">Registry Explorer - RecentDocs plugin view</span>](<span class="na">img/ntuser_analysis/04_recentdocs.png</span>)
</code></pre></div>
<h3 id="dfir-notes_2">DFIR Notes<a class="headerlink" href="#dfir-notes_2" title="Permanent link">&para;</a></h3>
<ul>
<li>Uses MRU lists and key LastWrite timestamps</li>
<li>Subkeys store ‚Äúextra timestamps‚Äù:</li>
<li>Each file-type subkey‚Äôs LastWrite = time the last file of that type was opened</li>
<li>Registry Explorer plugin includes <strong>Extension Last Opened</strong> column</li>
<li>MRU ordering helps <strong>time bounding / bookending</strong></li>
<li>If item is MRU position 41 opened at time T, the 40 above it were opened <strong>after T</strong></li>
</ul>
<hr />
<h2 id="step-5-office-file-mru-full-paths-timestamps">Step 5 ‚Äî Office File MRU (Full Paths + Timestamps)<a class="headerlink" href="#step-5-office-file-mru-full-paths-timestamps" title="Permanent link">&para;</a></h2>
<h3 id="registry-path-example-for-word-2016">Registry Path (Example for Word 2016+)<a class="headerlink" href="#registry-path-example-for-word-2016" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>NTUSER.DAT\Software\Microsoft\Office\16.0\Word\User MRU\ADAL_*\File MRU
</code></pre></div>
<blockquote>
<p>Note: The <code>ADAL_*</code> portion varies per user/environment. You may need to expand the tree to locate it. An example is <code>NTUSER.DAT\Software\Microsoft\Office\16.0\Word\User MRU\ ADAL_71509F4C9F29E24E25306165B32FE79B68FD54A88446B7C792A3A9D5AB6BB5AE\File MRU</code></p>
</blockquote>
<h3 id="what-it-shows_3">What it shows<a class="headerlink" href="#what-it-shows_3" title="Permanent link">&para;</a></h3>
<p>Office MRU provides:
   - Full path
   - Timestamps for every entry
   - Duration of access (Last Closed - Last Opened)</p>
<h3 id="procedure_4">Procedure<a class="headerlink" href="#procedure_4" title="Permanent link">&para;</a></h3>
<ol>
<li>Navigate to the NTUSER.DAT\Software\Microsoft\Office\16.0\Word\User MRU ADAL_*\File MRU key in Registry Explorer.</li>
<li>Document what drive letters were used to open Office files of interest (like Word documents) during the timeframe of interest (C:, D:, E:, etc.).</li>
<li>What drive letters may be Cloud storage like Google Drive? Look for paths like:<ul>
<li><code>Google Drive</code></li>
<li><code>OneDrive</code></li>
<li><code>SharePoint</code></li>
</ul>
</li>
<li>Identify any sensitive files opened (work with the network owner) and how long they were opened for (subtract Last Closed from Last Opened timestamp).</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>![<span class="nt">Registry Explorer - Office Word File MRU</span>](<span class="na">img/ntuser_analysis/05_office_file_mru.png</span>)
</code></pre></div>
<hr />
<h2 id="step-6-opensavepidlmru-opensave-dialog-artifacts">Step 6 ‚Äî OpenSavePidlMRU (Open/Save Dialog Artifacts)<a class="headerlink" href="#step-6-opensavepidlmru-opensave-dialog-artifacts" title="Permanent link">&para;</a></h2>
<h3 id="registry-path_3">Registry Path<a class="headerlink" href="#registry-path_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU
</code></pre></div>
<h3 id="what-it-shows_4">What it shows<a class="headerlink" href="#what-it-shows_4" title="Permanent link">&para;</a></h3>
<p>Files and folders interacted with via Open/Save dialogs. Most of the files referenced in OpenSavePidlMRU are also present in RecentDocs. However, this is a good data source to review largely because it provides full path information not available in RecentDocs.</p>
<h3 id="procedure_5">Procedure<a class="headerlink" href="#procedure_5" title="Permanent link">&para;</a></h3>
<ol>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU</code> key in Registry Explorer.</li>
<li>Use the full path information available here in the Absolute Path column to look for suspicious or sensitive files opened.</li>
<li>Document any suspicious or sensitive files along with the full path.</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>![<span class="nt">Registry Explorer - OpenSavePidlMRU absolute paths</span>](<span class="na">img/ntuser_analysis/06_opensavepidlmru.png</span>)
</code></pre></div>
<h3 id="dfir-notes_3">DFIR Notes<a class="headerlink" href="#dfir-notes_3" title="Permanent link">&para;</a></h3>
<ul>
<li>Often overlaps with RecentDocs</li>
<li>Provides <strong>full path info</strong> in Registry Explorer plugin (Absolute Path column)</li>
</ul>
<hr />
<h2 id="step-7-lastvisitedpidlmru-executable-correlation">Step 7 ‚Äî LastVisitedPidlMRU (Executable Correlation)<a class="headerlink" href="#step-7-lastvisitedpidlmru-executable-correlation" title="Permanent link">&para;</a></h2>
<h3 id="registry-path_4">Registry Path<a class="headerlink" href="#registry-path_4" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU
</code></pre></div>
<h3 id="what-it-shows_5">What it shows<a class="headerlink" href="#what-it-shows_5" title="Permanent link">&para;</a></h3>
<p>Associates the Open/Save dialog usage with the application executable responsible. </p>
<h3 id="procedure_6">Procedure<a class="headerlink" href="#procedure_6" title="Permanent link">&para;</a></h3>
<ol>
<li>Correlate OpenSavePidlMRU information with application information present in the LastVisitedPidlMRU key.</li>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU</code> key in Registry Explorer.</li>
<li>Reference timestamps and the MRU position to attempt to identify the Executable responsible for interacting with the file in question.</li>
<li>Only entries with timestamp values in the Opened On column can be validated, others will need more correlating information.</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>![<span class="nt">Registry Explorer - LastVisitedPidlMRU executable correlation</span>](<span class="na">img/ntuser_analysis/07_lastvisitedpidlmru.png</span>)
</code></pre></div>
<h3 id="dfir-notes_4">DFIR Notes<a class="headerlink" href="#dfir-notes_4" title="Permanent link">&para;</a></h3>
<ul>
<li>Some entries have timestamps in <strong>Opened On</strong></li>
<li>Only timestamped entries can be validated directly</li>
<li>Use MRU order + correlation with OpenSavePidlMRU for weak attribution</li>
</ul>
<hr />
<h2 id="step-8-run-key-user-persistence-startup-items">Step 8 ‚Äî Run Key (User Persistence / Startup Items)<a class="headerlink" href="#step-8-run-key-user-persistence-startup-items" title="Permanent link">&para;</a></h2>
<h3 id="registry-path_5">Registry Path<a class="headerlink" href="#registry-path_5" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run
</code></pre></div>
<h3 id="why-it-matters">Why it matters<a class="headerlink" href="#why-it-matters" title="Permanent link">&para;</a></h3>
<p>This key runs programs on every user logon and is the most common place for malware to add a reference to itself in an attempt to survive a reboot (commonly called a <strong>persistence mechanism</strong>).</p>
<h3 id="procedure_7">Procedure<a class="headerlink" href="#procedure_7" title="Permanent link">&para;</a></h3>
<ol>
<li>In addition to helping discover potential malware, this key also gives an indication of applications installed by the user.</li>
<li>Navigate to the <code>NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Run</code> key in Registry Explorer.</li>
<li>Document any suspicious entries such as:<ul>
<li>executables in <code>AppData\Roaming</code></li>
<li>scripts (<code>.vbs</code>, <code>.ps1</code>, <code>.js</code>, <code>.bat</code>)</li>
<li>references to Temp/Downloads</li>
<li>suspicious LOLBins (rundll32, regsvr32, mshta)</li>
</ul>
</li>
</ol>
<p>üì∏ <strong>Example Screenshot</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>![<span class="nt">Registry Explorer - Run key persistence</span>](<span class="na">img/ntuser_analysis/08_run_key.png</span>)
</code></pre></div>
<hr />
<h1 id="scaling-analysis-recmd-timeline-explorer">Scaling Analysis ‚Äì RECmd + Timeline Explorer<a class="headerlink" href="#scaling-analysis-recmd-timeline-explorer" title="Permanent link">&para;</a></h1>
<h2 id="why-scale">Why scale?<a class="headerlink" href="#why-scale" title="Permanent link">&para;</a></h2>
<p>Registry Explorer is excellent for investigative pivoting, but RECmd enables:
- bulk processing across many NTUSER.DAT hives
- consistent evidence extraction
- CSV outputs suited for timeline correlation</p>
<hr />
<h2 id="use-the-useractivityreb-batch-file">Use the UserActivity.reb Batch File<a class="headerlink" href="#use-the-useractivityreb-batch-file" title="Permanent link">&para;</a></h2>
<p>This workflow assumes <code>UserActivity.reb</code> exists under the <code>Batch</code> directory in your RECmd install path.</p>
<h3 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h3>
<ol>
<li>Open an <strong>Administrator Command Prompt</strong></li>
<li>Navigate to RECmd install directory</li>
<li>Run RECmd with batch:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">RECmd</span><span class="p">.</span><span class="n">exe</span> <span class="o">-f</span> <span class="s2">&quot;E:\C\Users\user1\NTUSER.DAT&quot;</span> <span class="p">-</span><span class="n">-bn</span> <span class="p">.\</span><span class="n">Batch</span><span class="p">\</span><span class="n">UserActivity</span><span class="p">.</span><span class="n">reb</span> <span class="p">-</span><span class="n">-csv</span> <span class="s2">&quot;G:\Evidence\Registry&quot;</span>
</code></pre></div>
<ol>
<li>Open output file in <strong>Timeline Explorer</strong>:<br />
      -<code>&lt;timestamp&gt;_RECmd_Batch_UserActivity_Output.csv</code></li>
<li>In Timeline Explorer, reset columns:<ul>
<li><code>Tools ‚Üí Reset column widths</code> (Ctrl+R is the keyboard shortcut)</li>
</ul>
</li>
<li>Focus analysis on:<ul>
<li><strong>Description</strong></li>
<li><strong>Key Path</strong></li>
<li><strong>Value Data</strong></li>
</ul>
</li>
<li>Document interesting findings</li>
<li>Review other CSV outputs for individual keys discussed above.</li>
</ol>
<hr />
<h2 id="evidence-review-guidance-recmd-output">Evidence Review Guidance (RECmd Output)<a class="headerlink" href="#evidence-review-guidance-recmd-output" title="Permanent link">&para;</a></h2>
<h3 id="look-for">Look for:<a class="headerlink" href="#look-for" title="Permanent link">&para;</a></h3>
<ul>
<li>unusual paths in <code>Value Data</code></li>
<li>references to:<ul>
<li><code>Temp</code></li>
<li><code>Downloads</code></li>
<li><code>AppData</code></li>
<li><code>\UNC\Paths</code></li>
<li>external drive letters (E:, F:)</li>
</ul>
</li>
<li>suspicious keywords:<ul>
<li><code>password</code></li>
<li><code>vpn</code></li>
<li><code>putty</code></li>
<li><code>winscp</code></li>
<li><code>rclone</code></li>
<li><code>7zip</code></li>
<li><code>keylogger</code></li>
<li><code>powershell</code></li>
</ul>
</li>
</ul>
<hr />
<h1 id="evidence-to-document">Evidence to Document<a class="headerlink" href="#evidence-to-document" title="Permanent link">&para;</a></h1>
<h2 id="user-activity-summary">User Activity Summary<a class="headerlink" href="#user-activity-summary" title="Permanent link">&para;</a></h2>
<ul>
<li>Suspicious searches (WordWheelQuery)</li>
<li>Suspicious typed locations (TypedPaths)</li>
<li>Recent documents &amp; extension timestamps (RecentDocs)</li>
<li>Office file access (File MRU)</li>
<li>Full path file access via dialog (OpenSavePidlMRU)</li>
<li>Executable attribution (LastVisitedPidlMRU)</li>
<li>Persistence artifacts (Run key)</li>
</ul>
<hr />
<h2 id="recommended-deliverables">Recommended Deliverables<a class="headerlink" href="#recommended-deliverables" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Artifact</th>
<th>Key Path</th>
<th>Evidence</th>
</tr>
</thead>
<tbody>
<tr>
<td>Search terms</td>
<td>WordWheelQuery</td>
<td>User intent + timeframe via LastWrite</td>
</tr>
<tr>
<td>Typed paths</td>
<td>TypedPaths</td>
<td>UNC paths, external drives, staging</td>
</tr>
<tr>
<td>Recent opened files</td>
<td>RecentDocs</td>
<td>Filenames, drive letters, time bounding</td>
</tr>
<tr>
<td>Office documents</td>
<td>Office File MRU</td>
<td>Full path + timestamps + open duration</td>
</tr>
<tr>
<td>Open/Save evidence</td>
<td>OpenSavePidlMRU</td>
<td>Full paths to sensitive/suspicious files</td>
</tr>
<tr>
<td>Executable correlation</td>
<td>LastVisitedPidlMRU</td>
<td>App attribution and MRU ordering</td>
</tr>
<tr>
<td>Persistence</td>
<td>Run</td>
<td>Logon execution artifacts</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="analyst-notes-pitfalls">Analyst Notes / Pitfalls<a class="headerlink" href="#analyst-notes-pitfalls" title="Permanent link">&para;</a></h2>
<ul>
<li>Many NTUSER artifacts are <strong>MRU-based</strong>, not timestamp-based</li>
<li>Always document <strong>key LastWrite time</strong></li>
<li>Validate major conclusions using:<ul>
<li>Event logs (Security 4624/4688)</li>
<li>Prefetch</li>
<li>SRUM</li>
<li>Jump Lists</li>
<li>File system timestamps</li>
</ul>
</li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>