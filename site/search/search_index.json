{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"DFIR Techniques","text":"<p>This documentation provides a comprehensive collection of Digital Forensics and Incident Response (DFIR) techniques, tools, and references across multiple domains.</p>"},{"location":"#navigation","title":"Navigation","text":"<p>Use the navigation menu to explore the following domains:</p> <ul> <li>Windows - Forensics techniques and tools for Windows systems</li> <li>Linux - Forensics techniques and tools for Linux systems  </li> <li>Networking - Network traffic analysis and investigation methods</li> <li>Cloud - Cloud forensics and investigation procedures</li> <li>Malware - Malware analysis techniques and tools</li> <li>ICS - Industrial Control Systems security and forensics</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<p>Select a domain from the navigation to view available tools, techniques, and references.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>This is an evolving resource for DFIR practitioners. Content is organized by domain and technique for easy reference.</p>"},{"location":"1.Windows/","title":"Windows Execution Artifacts for DFIR","text":"<p>This README provides a Digital Forensics &amp; Incident Response (DFIR)\u2013focused overview of three core Windows execution artifacts:</p> <ul> <li>Prefetch</li> <li>Amcache</li> <li>ShimCache (AppCompatCache)</li> </ul> <p>It explains what they are, why they matter, what they look like, and how to parse them using common forensic tools.</p>"},{"location":"1.Windows/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Prefetch</li> <li>Amcache</li> <li>ShimCache (AppCompatCache)</li> <li>Correlation &amp; Analyst Tips</li> <li>Tooling Summary</li> </ol>"},{"location":"1.Windows/#prefetch","title":"Prefetch","text":""},{"location":"1.Windows/#what-is-prefetch","title":"What is Prefetch?","text":"<p>Prefetch files are created by Windows to improve application startup performance. When an executable runs, Windows records metadata about its execution and the files it loads.</p> <p>From a DFIR perspective, Prefetch is one of the strongest indicators of program execution on a system.</p> <ul> <li>Enabled by default on most desktop versions of Windows</li> <li>Stored as <code>.pf</code> files</li> <li>Limited in count (typically 128\u20131024 files depending on OS)</li> </ul>"},{"location":"1.Windows/#location","title":"Location","text":"<pre><code>C:\\Windows\\Prefetch\\\n</code></pre> <p>Example filename:</p> <pre><code>POWERSHELL.EXE-3F0D7E6A.pf\n</code></pre>"},{"location":"1.Windows/#forensic-value","title":"Forensic Value","text":"<p>Prefetch can help answer:</p> <ul> <li>Was this program executed?</li> <li>How many times was it executed?</li> <li>When was it last executed?</li> <li>Which files and DLLs were accessed?</li> </ul> <p>This makes Prefetch extremely useful for:</p> <ul> <li>Malware execution confirmation</li> <li>Living-off-the-land (LOLbin) abuse</li> <li>Timeline reconstruction</li> </ul>"},{"location":"1.Windows/#key-data-points","title":"Key Data Points","text":"<ul> <li>Executable name</li> <li>Full path of executable</li> <li>Run count</li> <li>Last execution timestamp</li> <li>Referenced files and DLLs</li> </ul>"},{"location":"1.Windows/#example-output-pecmdexe","title":"Example Output (PECmd.exe)","text":"<pre><code>ExecutableName: POWERSHELL.EXE\nRunCount: 14\nLastRunTime: 2024-11-18 13:42:51 UTC\nFullPath: \\DEVICE\\HARDDISKVOLUME3\\WINDOWS\\SYSTEM32\\WINDOWSPOWERSHELL\\V1.0\\POWERSHELL.EXE\n\nReferenced Files:\n- KERNEL32.DLL\n- NTDLL.DLL\n- AMSI.DLL\n</code></pre>"},{"location":"1.Windows/#tools-for-prefetch","title":"Tools for Prefetch","text":""},{"location":"1.Windows/#pecmdexe-eric-zimmerman","title":"PECmd.exe (Eric Zimmerman)","text":"<p>Parse Prefetch files:</p> <pre><code>PECmd.exe -d C:\\Windows\\Prefetch --csv prefetch.csv\n</code></pre> <p>Common flags:</p> <ul> <li><code>-d</code> : Directory of Prefetch files</li> <li><code>--csv</code> : Export to CSV</li> <li><code>--json</code> : Export to JSON</li> </ul>"},{"location":"1.Windows/#amcache","title":"Amcache","text":""},{"location":"1.Windows/#what-is-amcache","title":"What is Amcache?","text":"<p>Amcache tracks application installation and execution metadata. It is especially valuable because it may record executables that never generated Prefetch.</p> <p>Amcache was significantly expanded starting in Windows 8+.</p>"},{"location":"1.Windows/#location_1","title":"Location","text":"<p>Primary hive:</p> <pre><code>C:\\Windows\\AppCompat\\Programs\\Amcache.hve\n</code></pre>"},{"location":"1.Windows/#forensic-value_1","title":"Forensic Value","text":"<p>Amcache can provide:</p> <ul> <li>Executable file paths</li> <li>File hashes (SHA1)</li> <li>Compilation timestamps</li> <li>First-seen timestamps</li> <li>Program metadata (company name, product name)</li> </ul> <p>This is critical for:</p> <ul> <li>Identifying dropped malware</li> <li>Detecting renamed binaries</li> <li>Validating attacker toolkits</li> </ul>"},{"location":"1.Windows/#key-data-points_1","title":"Key Data Points","text":"<ul> <li>File path</li> <li>SHA1 hash</li> <li>File size</li> <li>Compile time</li> <li>First execution time</li> <li>Program name and vendor</li> </ul>"},{"location":"1.Windows/#example-output-amcacheparser","title":"Example Output (AmcacheParser)","text":"<pre><code>Path: C:\\Users\\Public\\svchost.exe\nSHA1: 9f2c3e9f1a9d7b9a7a5c5d8f3b2a1e4c6d9e8f7a\nCompileTime: 2023-09-12 08:15:22 UTC\nFirstRunTime: 2024-11-17 02:31:44 UTC\nCompany: Microsoft Corporation\n</code></pre>"},{"location":"1.Windows/#tools-for-amcache","title":"Tools for Amcache","text":""},{"location":"1.Windows/#amcacheparserexe-eric-zimmerman","title":"AmcacheParser.exe (Eric Zimmerman)","text":"<pre><code>AmcacheParser.exe -f Amcache.hve --csv amcache.csv\n</code></pre> <p>Useful flags:</p> <ul> <li><code>-f</code> : Path to Amcache hive</li> <li><code>--csv</code> : CSV output</li> <li><code>--json</code> : JSON output</li> </ul>"},{"location":"1.Windows/#shimcache-appcompatcache","title":"ShimCache (AppCompatCache)","text":""},{"location":"1.Windows/#what-is-shimcache","title":"What is ShimCache?","text":"<p>ShimCache, also known as AppCompatCache, is part of the Windows Application Compatibility framework.</p> <p>It records executables to determine whether compatibility shims are required.</p> <p>\u26a0\ufe0f Important: ShimCache does NOT reliably indicate execution \u2014 it only indicates that Windows was aware of the file.</p>"},{"location":"1.Windows/#location_2","title":"Location","text":"<p>Stored in the SYSTEM registry hive:</p> <pre><code>HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache\n</code></pre> <p>Offline hive:</p> <pre><code>SYSTEM\n</code></pre>"},{"location":"1.Windows/#forensic-value_2","title":"Forensic Value","text":"<p>ShimCache can help:</p> <ul> <li>Identify presence of executables</li> <li>Discover files that were deleted</li> <li>Detect attacker staging activity</li> </ul> <p>Best used in correlation with other artifacts.</p>"},{"location":"1.Windows/#key-data-points_2","title":"Key Data Points","text":"<ul> <li>File path</li> <li>Last modified timestamp</li> <li>File size (varies by OS)</li> </ul>"},{"location":"1.Windows/#example-output-appcompatcacheparser","title":"Example Output (AppCompatCacheParser)","text":"<pre><code>Path: C:\\Temp\\mimikatz.exe\nLastModified: 2024-11-16 22:10:03 UTC\nFileSize: 856064\n\nExecutionFlag: Unknown\n</code></pre>"},{"location":"1.Windows/#tools-for-shimcache","title":"Tools for ShimCache","text":""},{"location":"1.Windows/#appcompatcacheparserexe-eric-zimmerman","title":"AppCompatCacheParser.exe (Eric Zimmerman)","text":"<pre><code>AppCompatCacheParser.exe -f SYSTEM --csv shimcache.csv\n</code></pre> <p>Common flags:</p> <ul> <li><code>-f</code> : SYSTEM hive</li> <li><code>--csv</code> : CSV output</li> <li><code>--json</code> : JSON output</li> </ul>"},{"location":"1.Windows/#correlation-analyst-tips","title":"Correlation &amp; Analyst Tips","text":""},{"location":"1.Windows/#execution-confidence-ranking","title":"Execution Confidence Ranking","text":"Artifact Execution Confidence Prefetch High Amcache Medium\u2013High ShimCache Low"},{"location":"1.Windows/#analyst-tips","title":"Analyst Tips","text":"<ul> <li>Correlate timestamps across artifacts</li> <li>Look for renamed LOLbins (e.g., <code>svchost.exe</code> in user directories)</li> <li>Use Amcache hashes to pivot into malware databases</li> <li>Prefetch absence does not mean no execution</li> </ul>"},{"location":"1.Windows/#tooling-summary","title":"Tooling Summary","text":"Artifact Tools Prefetch PECmd.exe Amcache AmcacheParser.exe ShimCache AppCompatCacheParser.exe <p>Additional Helpful Tools:</p> <ul> <li>Timeline Explorer</li> <li>KAPE</li> <li>Plaso / log2timeline</li> </ul>"},{"location":"1.Windows/#references","title":"References","text":"<ul> <li>Eric Zimmerman Tools</li> <li>Microsoft Windows Internals</li> <li>SANS DFIR Posters</li> </ul> <p>Author: DFIR Reference</p>"},{"location":"1.Windows/1.Evidence_Of_Execution/","title":"Overview","text":"<p>This is a page of evidence of execution</p>"},{"location":"1.Windows/1.Evidence_Of_Execution/1.01-Prefetch/","title":"1.01 - Prefetch","text":"<p>This is a discussion on Windows Prefetch</p>"},{"location":"1.Windows/1.Evidence_Of_Execution/1.02-ShimCache/","title":"1.02 - ShimCache","text":"<p>This is a discussion on ShimCache</p>"},{"location":"1.Windows/1.Evidence_Of_Execution/1.03-Amcache.hve/","title":"1.03 - Amcache.hve","text":"<p>This is a discussion on Amcache</p>"},{"location":"1.Windows/1.Evidence_Of_Execution/1.04-Scaling_Evidence_of_Execution_Analysis/","title":"1.04 - Scaling Evidence of Execution Analysis","text":"<p>Discussion on scaling EoE Analysis</p>"}]}